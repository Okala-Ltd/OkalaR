% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api.R
\name{build_observation_payload}
\alias{build_observation_payload}
\title{Build Observation Payload from Dataframe}
\usage{
build_observation_payload(observations_df, features_df)
}
\arguments{
\item{observations_df}{A dataframe with one row per observation containing:
\itemize{
  \item feature_uuid: UUID grouping observations into features
  \item observation_uuid: Unique ID for this observation
  \item observation_created_at: Timestamp when observation was recorded
  \item item_uuid: ID of the item/question being answered
  \item item_type: Type of observation (text, numeric, choice, label,
    phone-photo, phone-video, phone-audio)
  \item observation_value: The value(s) - for media, use filename
  \item longitude: Observation point longitude
  \item latitude: Observation point latitude
}}

\item{features_df}{A dataframe with one row per feature containing:
\itemize{
  \item feature_uuid: UUID for the feature
  \item project_system_id: Project system ID
  \item procedure_id: Procedure ID
  \item procedure_start_timestamp: Start time
  \item procedure_end_timestamp: End time
  \item created_by_method: Method (e.g., "drawn", "gps")
  \item geometry_type: "Point", "Polygon", etc.
  \item geometry_coords: JSON string or list of coordinates
}}
}
\value{
A list structure ready for push_phone_observations
}
\description{
Helper function to convert flat dataframes into the nested structure
required by push_phone_observations. Makes it easier to work with
observations in R's tabular format.
}
\examples{
\dontrun{
  # Create observations dataframe
  obs_df <- data.frame(
    feature_uuid = rep("feature-1", 2),
    observation_uuid = c("obs-1", "obs-2"),
    observation_created_at = Sys.time(),
    item_uuid = c("item-1", "item-2"),
    item_type = c("text", "numeric"),
    observation_value = c("Tree", "15"),
    longitude = c(-0.05, -0.05),
    latitude = c(51.55, 51.55)
  )
  
  # Create features dataframe
  feat_df <- data.frame(
    feature_uuid = "feature-1",
    project_system_id = 123,
    procedure_id = 456,
    procedure_start_timestamp = Sys.time(),
    procedure_end_timestamp = Sys.time(),
    created_by_method = "drawn",
    geometry_type = "Polygon",
    geometry_coords = '[[[−0.1,51.5],[−0.1,51.6],[0,51.6],[0,51.5],[−0.1,51.5]]]'
  )
  
  payload <- build_observation_payload(obs_df, feat_df)
}

}
\author{
Adam Varley
}
