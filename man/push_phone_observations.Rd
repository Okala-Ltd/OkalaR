% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api.R
\name{push_phone_observations}
\alias{push_phone_observations}
\title{Push Phone Observations}
\usage{
push_phone_observations(
  hdr,
  project_id,
  feature_payload,
  device_settings,
  media_files = NULL
)
}
\arguments{
\item{hdr}{A list containing the root URL and API key for authentication
(from auth_headers()).}

\item{project_id}{The project ID to which observations will be uploaded.}

\item{feature_payload}{A list of feature records. Each feature should have:
\itemize{
  \item feature_uuid: UUID for the feature (character)
  \item project_system_id: Project system ID (integer)
  \item procedure_id: Procedure ID (integer)
  \item procedure_start_timestamp: Start timestamp (POSIXct or character)
  \item procedure_end_timestamp: End timestamp (POSIXct or character)
  \item created_by_method: Method used (e.g., "drawn", "gps")
  \item geometry: GeoJSON geometry object (list with type and coordinates)
  \item observations: List of observation features (see details)
}}

\item{device_settings}{A list containing device metadata:
\itemize{
  \item battery_level: Battery percentage (0-100)
  \item carrier: Mobile carrier name
  \item build_number: App build number
  \item build_id: App build ID
  \item device_id: Unique device identifier
  \item phone_model: Device model
  \item phone_operating_system: OS version
  \item device_created_at: Device creation timestamp
  \item device_last_used: Last usage timestamp
}}

\item{media_files}{Optional list of file paths to upload. Files are matched
by filename in observation data arrays.}
}
\value{
A tibble with upload response messages
}
\description{
Uploads field observations from mobile devices to the Okala platform.
Supports uploading features with observations and optional media files
(photos, videos, audio).
}
\details{
Each observation in feature_payload should be a GeoJSON Feature with:
\itemize{
  \item type: "Feature"
  \item geometry: Point geometry with coordinates
  \item properties: List with item_uuid, item_type, observation_uuid,
    observation_created_at, and data (array of values/filenames)
}

For media observations (phone-photo, phone-video, phone-audio), the data
array should contain filenames that match the media_files parameter.
}
\examples{
\dontrun{
  headers <- auth_headers()
  
  # Define feature with observations
  feature <- list(
    feature_uuid = uuid::UUIDgenerate(),
    project_system_id = 123,
    procedure_id = 456,
    procedure_start_timestamp = Sys.time(),
    procedure_end_timestamp = Sys.time(),
    created_by_method = "drawn",
    geometry = list(
      type = "Polygon",
      coordinates = list(list(
        c(-0.1, 51.5),
        c(-0.1, 51.6),
        c(0.0, 51.6),
        c(0.0, 51.5),
        c(-0.1, 51.5)
      ))
    ),
    observations = list(
      list(
        type = "Feature",
        geometry = list(type = "Point", coordinates = c(-0.05, 51.55)),
        properties = list(
          item_uuid = uuid::UUIDgenerate(),
          item_type = "text",
          observation_uuid = uuid::UUIDgenerate(),
          observation_created_at = Sys.time(),
          data = list("Sample observation")
        )
      )
    )
  )
  
  device <- list(
    battery_level = 85,
    carrier = "Vodafone",
    build_number = "1.0.0",
    build_id = "build-123",
    device_id = "device-xyz",
    phone_model = "iPhone 14",
    phone_operating_system = "iOS 17",
    device_created_at = Sys.time(),
    device_last_used = Sys.time()
  )
  
  result <- push_phone_observations(
    headers,
    project_id = 1,
    feature_payload = list(feature),
    device_settings = device
  )
}

}
\author{
Adam Varley
}
