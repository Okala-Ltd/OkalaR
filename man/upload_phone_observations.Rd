% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phone_observations.R
\name{upload_phone_observations}
\alias{upload_phone_observations}
\title{Upload Phone Observations}
\usage{
upload_phone_observations(
  hdr,
  project_id,
  feature_payload,
  device_settings,
  media_dir = NULL,
  validate = TRUE
)
}
\arguments{
\item{hdr}{A base URL and API key returned by \link{auth_headers} or \link{auth_headers_dev}.}

\item{project_id}{Integer. The ID of the project to upload observations to.}

\item{feature_payload}{List. A list of feature records created with \code{build_feature_record()}.}

\item{device_settings}{List. Device settings created with \code{build_device_settings()}.}

\item{media_dir}{Character or NULL. Path to the directory containing media files.
Required if any observations include media types (photo, video, audio).}

\item{validate}{Logical. Whether to validate the payload before uploading. Default is TRUE.}
}
\value{
A list containing:
  \describe{
    \item{successes}{List of successfully uploaded feature UUIDs with their responses}
    \item{failures}{List of failed feature UUIDs with their error messages}
    \item{summary}{Character string summarizing the upload results}
  }
}
\description{
Uploads phone observation records to the Okala platform. This function processes
one feature at a time, uploading the feature geometry, its child observations,
and any associated media files (photos, videos, audio) in a single request per feature.

The function loops through all features in the payload, providing progress messages
and collecting any errors that occur. Partial failures do not stop the upload process;
instead, errors are collected and returned in the summary.
}
\examples{
\dontrun{
  # Set up authentication
  hdr <- auth_headers("your_api_key")

  # Build device settings
  device <- build_device_settings(
    device_id = "device-123",
    phone_model = "iPhone 14",
    phone_os = "iOS 17",
    carrier = "Vodafone",
    build_number = "1.0.0",
    build_id = "build-001"
  )

  # Build an observation
  obs1 <- build_observation(
    item_uuid = "item-uuid-1",
    item_type = "text",
    data = list("My observation text"),
    geometry = list(type = "Point", coordinates = c(-1.5, 53.4))
  )

  # Build a feature with observations
  feature1 <- build_feature_record(
    feature_uuid = "feature-uuid-1",
    project_system_id = 10,
    procedure_id = 5,
    start_time = Sys.time() - 3600,
    end_time = Sys.time(),
    created_by_method = "drawn",
    geometry = list(type = "Point", coordinates = c(-1.5, 53.4)),
    observations = list(obs1)
  )

  # Upload
  result <- upload_phone_observations(
    hdr = hdr,
    project_id = 42,
    feature_payload = list(feature1),
    device_settings = device
  )

  print(result$summary)
}

}
\author{
Adam Varley
}
